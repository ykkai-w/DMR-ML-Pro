# DMR-ML Pro v1.0-内测版

> 基于机器学习的双重动量轮动量化交易系统

---

## 📋 系统简介

**DMR-ML Pro** 是一款专业的量化交易系统，结合了传统的双重动量轮动策略（DMR）与现代机器学习风险控制模型（ML），旨在帮助投资者做出更理性的投资决策。

### ✨ 核心特性

- 📊 **策略回测**：基于2019-2026历史数据的完整回测
- 🎯 **今日信号**：每日A股开盘前提供操作建议
- 🔬 **深度分析**：月度收益、滚动夏普、回撤分析
- 📜 **交易记录**：完整的交易信号和资产配置历史
- 📧 **邮件订阅**：每日自动推送操作信号（内测用户专属）

### 🔐 核心技术

- **Purged Walk-Forward**：防止标签泄露的滚动训练
- **双阈值迟滞机制**：触发40%/解除33%，减少频繁切换
- **随机森林模型**：100棵决策树，最大深度5

---

## 🚀 快速开始

### 🎯 超简单方式

**给不熟悉编程的用户：**

#### Windows用户
1. 双击 `🚀DMR-ML-Pro启动器.bat`
2. 首次运行会自动安装依赖（1-2分钟）
3. 浏览器自动打开，开始使用！

#### macOS用户
1. 双击 `🚀DMR-ML-Pro启动器.command`
2. 如提示无法打开，右键→"打开"→"打开"
3. 首次运行会自动安装依赖（1-2分钟）
4. 浏览器自动打开，开始使用！

> 💡 详细教程请查看 **`📖快速开始指南.md`**

---

### 🛠️ 开发者/高级用户方式

#### 1️⃣ 系统要求

- **操作系统**：Windows 10+, macOS 10.14+, Linux
- **Python版本**：3.8 - 3.11
- **内存**：建议 4GB+
- **网络**：需要联网获取股票数据

#### 2️⃣ 安装依赖

```bash
# 进入项目目录
cd DMR_Pro_System

# 安装Python依赖
pip install -r requirements.txt
```

#### 3️⃣ 配置Tushare Token

**获取Token**：
1. 注册Tushare账号：https://tushare.pro/register
2. 获取API Token

**配置方法**（三选一）：

**方法A - 环境变量（推荐）**：
```bash
# macOS/Linux
export TUSHARE_TOKEN="您的Token"

# Windows (PowerShell)
$env:TUSHARE_TOKEN="您的Token"
```

**方法B - 修改配置文件**：
编辑 `config.py`，找到：
```python
TUSHARE_TOKEN = os.environ.get('TUSHARE_TOKEN', '您的Token')
```

**方法C - 运行时输入**：
程序首次运行时会提示输入Token

#### 4️⃣ 启动系统

```bash
# 方式1：Streamlit Web界面（推荐）
streamlit run app_dashboard.py

# 方式2：命令行工具
python run.py web        # Web界面
python run.py backtest   # 回测分析
python run.py signal     # 今日信号
```

---

## 📖 使用指南

### Web界面操作

1. **启动后自动打开浏览器**
   - 默认地址：http://localhost:8501
   - 如未自动打开，手动访问该地址

2. **主要功能标签**
   - **📊 策略概览**：查看回测表现和核心指标
   - **🎲 今日信号**：获取最新操作建议
   - **🔬 深度分析**：详细的收益分析和风险评估
   - **📜 交易记录**：历史交易信号和资产配置

3. **参数调整**
   - 左侧边栏可调整策略参数
   - 默认值已为最优回测结果
   - 修改后实时更新

4. **邮件订阅**（内测用户专属）
   - 展开"📬 内测用户专属福利"
   - 输入邮箱并选择推送时间
   - 每日A股开盘前收到操作信号

---

## ⚙️ 配置说明

### 主要配置项

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| 动量窗口 | 20 | 动量计算周期 |
| 均线窗口 | 14 | 均线计算周期 |
| ML触发阈值 | 40% | 风险预警触发阈值 |
| ML解除阈值 | 33% | 风险预警解除阈值 |

### 数据缓存

- 缓存位置：`cache_dmr_pro/`
- 自动更新：每日首次运行时更新
- 手动清除：删除缓存文件夹即可

---

## 🎯 策略说明

### DMR（双重动量轮动）

通过计算沪深300和中证1000的相对动量，选择表现更好的指数进行配置。

### ML（机器学习风险控制）

使用随机森林模型预测未来5日下跌风险，高风险时触发空仓避险。

### 完整流程

```
1. 计算双重动量信号 → DMR信号（沪深300/中证1000）
2. ML模型预测风险概率 → 是否触发避险
3. 综合判断 → 最终信号（沪深300/中证1000/空仓）
4. 执行建议 → 下一交易日开盘执行
```

---

## 📊 回测表现（2019-2026）

| 指标 | DMR-ML Pro | 沪深300 | 超额收益 |
|------|-----------|---------|----------|
| 累计收益 | 207.9% | 58.3% | +149.6% |
| 年化收益 | 17.3% | 7.0% | +10.3% |
| 最大回撤 | -12.7% | -45.6% | 改善32.9% |
| 夏普比率 | 1.04 | 0.29 | +0.75 |
| 胜率 | 42.3% | - | - |

---

## ⚠️ 风险提示

1. **历史业绩不代表未来表现**
   - 本系统基于历史数据回测
   - 实际收益可能与回测结果存在差异

2. **投资有风险，决策需谨慎**
   - 本系统仅供参考，不构成投资建议
   - 请根据自身风险承受能力决策

3. **市场环境变化**
   - A股市场可能发生结构性变化
   - 建议定期评估策略有效性

---

## 🐛 故障排除

### 常见问题

**Q1：启动时提示"找不到模块"**
```bash
# 重新安装依赖
pip install -r requirements.txt --upgrade
```

**Q2：获取数据失败**
```bash
# 检查Tushare Token是否配置正确
# 检查网络连接
# 检查Tushare积分是否足够
```

**Q3：中文显示乱码**
```bash
# macOS用户确保字体配置正确
# 已在dmr_ml.py中配置了Arial Unicode MS等字体
```

**Q4：邮件发送失败**
```bash
# 检查QQ邮箱授权码是否正确
# 确认已关闭VPN/代理
# 检查网络连接
```

---

## 👨‍💻 关于开发者

**ykai-w 团队**（目前为个人运营）

**Kai** · CAU 金融学 & 数据科学 在读

### 联系方式

- ✉️ 个人邮箱：ykai.w@outlook.com
- 💻 GitHub：github.com/ykai-w

### 反馈渠道

欢迎通过以下方式反馈：
- 邮件联系
- GitHub Issues
- 直接回复订阅邮件

---

## 📄 许可证

**DMR-ML Pro v1.0-内测版**

© 2026 ykai-w. All rights reserved.

本软件仅供学习和研究使用，未经授权不得用于商业用途。

---

## 🎉 感谢使用

感谢您成为DMR-ML Pro的首批内测用户！

您的反馈将直接影响产品的发展方向。期待与您共同进步！

---

**最后更新**：2026-01-24
**版本**：v1.0-内测版
